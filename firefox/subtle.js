!function(t){function e(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,e,n){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=51)}({0:function(t,e,n){"use strict";var a="https://api.subtletab.com/",o={THEME:{NATURE:"nature",ARCHITECTURE:"building",TRAVEL:"travel",NIGHT:"night"},STORAGE:{SHARED_DATA:"shared-data",MISC_SETTINGS:"misc_settings",WEATHER:"weather",BACKGROUND_SEEN_NIGHT:"bg-seen-night",BACKGROUND_SEEN_TRAVEL:"bg-seen-travel",BACKGROUND_SEEN_BUILDING:"bg-seen-building",BACKGROUND_SEEN_NATURE:"bg-seen-nature",BACKGROUND_CUSTOM:"bg-custom",BACKGROUND_SEEN_CUSTOM:"bg-seen-custom",CURRENT_PAGE:"current-page",SEEN_ONBOARDING:"seen-onboarding",NOTES_META:"notes_meta",WHATS_NEW:"whats_new",CURRENT_CUSTOMIZATION_TAB:"current_c_tab",SUBTLE_USER:"subtle_user"},SYNC:["shared-data","bg-seen-nature","bg-seen-night","bg-seen-travel","bg-seen-building","current-page","nature","travel","building","night","notes_meta","notes-","bg-custom","bg-seen-custom","misc_settings","subtle_user"],URL:{WHATS_NEW:a+"whatsnew"}};e.a=o},1:function(t,e,n){"use strict";var a=n(0),o={get:function(t){if(t){var e=localStorage.getItem(t);return JSON.parse(e)}},set:function(t,e){if(t&&void 0!==e&&null!==e){if(a.a.SYNC.indexOf(t)>-1||t.indexOf("note-")>-1){var n={};n[t]=e,chrome.storage.sync.set(n)}localStorage.setItem(t,JSON.stringify(e))}},setLocal:function(t,e){t&&void 0!==e&&null!==e&&localStorage.setItem(t,JSON.stringify(e))},remove:function(t){return localStorage.removeItem(t)},increment:function(t){var e=this.get(t);"number"==typeof e&&this.set(t,e+1)},append:function(t,e){var n=this.get(t)||[];n.push(e),this.set(t,n)},getMap:function(t){var e=localStorage.getItem(t);return isNaN(e)?JSON.parse(e):e},setMap:function(t,e){return localStorage.setItem(t,JSON.stringify(e))},chromeSync:{get:function(t,e){try{chrome.storage.sync.get(t,function(t){e&&e(t)})}catch(t){console.log(t)}},set:function(t,e,n){try{var a={};a[t]=e,chrome.storage.sync.set(a,function(t){n&&n(t)})}catch(t){console.log(t)}}}};e.a=o},2:function(t,e,n){"use strict";e.a={themes:[{id:1,lValue:"Nature",tags:"nature",value:"nature",imgUrl:"images/nature_thumbnail.png"},{id:2,lValue:"Architecture",tags:"building",value:"building",imgUrl:"images/architecture_thumbnail.png"},{id:3,lValue:"Travel",tags:"travel",value:"travel",imgUrl:"images/travel_thumbnail.png"},{id:4,lValue:"Night Life",tags:"night",value:"night",imgUrl:"images/night_thumbnail.png"}],stored:{1:{1:"./images/backgrounds/nature-1.jpg",2:"./images/backgrounds/nature-2.jpg",3:"./images/backgrounds/nature-3.jpg"},2:{4:"./images/backgrounds/building-1.jpg",5:"./images/backgrounds/building-2.jpg",6:"./images/backgrounds/building-3.jpg"},3:{7:"./images/backgrounds/travel-1.jpg",8:"./images/backgrounds/travel-2.jpg",9:"./images/backgrounds/travel-3.jpg"},4:{10:"./images/backgrounds/night-1.jpg",11:"./images/backgrounds/night-2.jpg",12:"./images/backgrounds/night-3.jpg"}},customBackgrounds:["https://subtletab.com/extras/1.jpg","https://subtletab.com/extras/2.jpg","https://subtletab.com/extras/3.jpg","https://subtletab.com/extras/4.jpg","https://subtletab.com/extras/5.jpg","https://subtletab.com/extras/6.jpg","https://subtletab.com/extras/7.jpg","https://subtletab.com/extras/7.jpg","https://subtletab.com/extras/8.jpg"]}},3:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),e.a={http:function(t,e,n){return new Promise(function(a,o){var r=new XMLHttpRequest;e=e||"GET",r.open(e,t),r.setRequestHeader("chrome-extension",btoa(chrome.runtime.id)),r.onreadystatechange=function(){if(4===r.readyState){if(r.responseText)return void a(JSON.parse(r.responseText));o(r.status)}},r.onerror=function(){o(r.status)},r.send(JSON.stringify(n))})},isObject:function(t){return t&&"[object Object]"===Object.prototype.toString.call(t)},isArray:function(t){return t&&"[object Array]"===Object.prototype.toString.call(t)},isUndefined:function(t){return"undefined"==typeof t}};var a=function(){return"xxxxxxxx-xxxx-Sxxx-Uxxx-xxxxxxxxxxxx\n".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})}},4:function(t,e,n){"use strict";var a={defaultCustomization:{showUtilities:{showWeather:!0,showClock:!0,showNotes:!0},clock:{showTwelveHour:!0,showDay:!0,type:"twelve"},weather:{unit:"c",location:{type:"geo",name:""}},background:{themeId:1,changeInterval:2,type:"predefined"}},misc:{update:{lastChecked:"0020",isToBeFetched:!0,isSeen:!0}},other:{weather:{showWeatherInfo:!1}}};e.a=a},51:function(t,e,n){t.exports=n(9)},9:function(t,e,n){"use strict";function a(){return S!==v&&v}function o(t){v=t}function r(t){if(t&&t.photo){for(var e=Object.keys(t.photo),n=t.photo,a=d.a.get(f.a.STORAGE.BACKGROUND_SEEN)||[],o={},r=0;r<e.length;r++)a.indexOf(n[e[r]])===-1&&(o[e[r]]=n[e[r]]);return o}}function i(t){var e="https://api.subtletab.com/weather";e+="custom"!==t.type?"?lat="+t.lat+"&long="+t.long+"&type=geo":"?location="+t.location+"&type=custom",p.a.http(e).then(function(t){d.a.set(f.a.STORAGE.WEATHER,t)})}function s(t){var e={};"custom"!==t.weather.location.type?navigator.geolocation.getCurrentPosition(function(t){e={lat:t.coords.latitude,long:t.coords.longitude,type:"geo"},i(e)},function(t){w(t)},{timeout:1e4}):(e={location:t.weather.location.name,type:"custom"},i(e))}function u(){var t=d.a.get(f.a.STORAGE.SHARED_DATA);t&&t.showUtilities.showWeather?_||(_=setInterval(function(){navigator.onLine?(t=d.a.get(f.a.STORAGE.SHARED_DATA),s(t)):c()},9e5)):c()}function c(){clearInterval(_)}function g(){var t=void 0,e=void 0;if(t=d.a.get(f.a.STORAGE.SHARED_DATA),e=d.a.get(f.a.STORAGE.MISC_SETTINGS),t&&p.a.isObject(t)){if(t.weather&&p.a.isUndefined(t.weather.location)){var n=d.a.get(f.a.STORAGE.WEATHER);t.weather.location=m.a.defaultCustomization.weather.location,p.a.isObject(n)&&!t.weather.location.name&&(t.weather.location.name=n[4]||n.city||"")}t.showUtilities&&p.a.isUndefined(t.showUtilities.showNotes)&&(t.showUtilities.showNotes=!0),t.background&&p.a.isUndefined(t.background.type)&&(t.background.type="predefined",d.a.set(f.a.STORAGE.BACKGROUND_CUSTOM,h.a.customBackgrounds)),d.a.remove(f.a.STORAGE.WEATHER)}e&&p.a.isObject(e)&&(e.update.isToBeFetched=!0,e.update.lastChecked="002"),d.a.set(f.a.STORAGE.SHARED_DATA,t),d.a.set(f.a.STORAGE.MISC_SETTINGS,e)}function l(){chrome.runtime.setUninstallURL("https://www.subtletab.com/uninstall"),chrome.storage.sync.get(null,function(t){for(var e in t)t.hasOwnProperty(e)&&d.a.setLocal(e,t[e])}),chrome.tabs.onCreated.addListener(function(){S=v,v++,2===v&&d.a.set(f.a.STORAGE.SEEN_ONBOARDING,!0)})}var d=n(1),f=n(0),m=n(4),h=n(2),p=n(3),b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v=0,S=0,E=void 0,T=!1;chrome.runtime.onMessage.addListener(function(t,e,n){return"getBackground"===t.query?O(t.theme,t.newPage):"getTabsCount"===t.query?n(a()):"setTabsCount"===t.query?(o(t.value),n(!0)):"loadNextBackground"===t.query?R(t.url):"loadCurrentBackground"===t.query?y(t.url,n):"log"===t.query?w(t.value):"startWeather"===t.query?u():"loadCurrentCustomBackground"===t.query?A(t.url,n):"loadNextCustomBackground"===t.query&&R(t.url),!0});var y=function(t,e){var n=!1,a=new Image;a.src=t,a.onload=function(){n||(clearTimeout(o),e(t))},a.onerror=function(){clearTimeout(o),n=!0,e(!1)};var o=setTimeout(function(){n=!0,e(!1)},2e3)},A=function(t,e){var n=!1,a=new Image;a.src=t,a.onload=function(){n||(clearTimeout(o),e(t))},a.onerror=function(){clearTimeout(o),n=!0,e(!1)};var o=setTimeout(function(){n=!0,e(!1)},4e3)},O=function(t,e){return new Promise(function(n,a){var o=d.a.get(f.a.STORAGE.CURRENT_PAGE)||{},i=o[t.value]||0;e&&i++;var s="https://api.subtletab.com/theme/";s+=t.tags+"/"+i,p.a.http(s).then(function(a){E=r(a),i===a.pages&&(i=0),e&&d.a.set(f.a.STORAGE["BACKGROUND_SEEN_"+t.value.toUpperCase()],""),o[t.value]=i,d.a.set(f.a.STORAGE.CURRENT_PAGE,o),N(E,t),n()},function(t){a(t)})})},N=function(t,e){var n=d.a.get(f.a.THEME[e.value]);if(!n)return void d.a.set(e.value,t);var a=Object.keys(n),o=a[a.length],r=n[o],i={};i[o]=r,d.a.set(e.value,Object.assign({},i,t))},x=void 0,R=function(t){if(x=x||t,x!==t){w("BG: Load Next Background for",t),x=t;var e=new Image;e.src=t}},w=function(t){T&&console.log(t)};chrome.runtime.onInstalled.addListener(function(t){t&&t.reason&&"install"===t.reason?(d.a.chromeSync.get(null,function(t){var e=void 0;for(e in t)t.hasOwnProperty(e)&&d.a.setLocal(e,t[e])}),chrome.tabs.create({})):t&&t.reason&&"update"===t.reason&&g()}),chrome.browserAction.onClicked.addListener(function(t){chrome.tabs.create({})}),chrome.storage.onChanged.addListener(function(t,e){var n=void 0;for(n in t)t.hasOwnProperty(n)&&(w("Storage Changed"+JSON.stringify(t[n])),void 0!==b(t[n].newValue)?d.a.setLocal(n,t[n].newValue):d.a.remove(n))});var _=void 0;l()}});